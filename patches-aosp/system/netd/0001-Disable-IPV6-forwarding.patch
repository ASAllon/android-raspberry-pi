From 5a09f0d4bb2b1124a04998190ae5e70cbb74cba8 Mon Sep 17 00:00:00 2001
From: "jenkins@teslaandroid.com" <jenkins@teslaandroid.com>
Date: Fri, 19 May 2023 08:10:58 +0000
Subject: [PATCH 1/2] Disable IPV6 forwarding

Change-Id: Iace59dbe567e314e06848178ef6107c5a82aab5f
---
 server/TetherController.cpp | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/server/TetherController.cpp b/server/TetherController.cpp
index 7919357..e5b57d7 100644
--- a/server/TetherController.cpp
+++ b/server/TetherController.cpp
@@ -74,7 +74,7 @@ namespace {
 
 const char BP_TOOLS_MODE[] = "bp-tools";
 const char IPV4_FORWARDING_PROC_FILE[] = "/proc/sys/net/ipv4/ip_forward";
-const char IPV6_FORWARDING_PROC_FILE[] = "/proc/sys/net/ipv6/conf/all/forwarding";
+//const char IPV6_FORWARDING_PROC_FILE[] = "/proc/sys/net/ipv6/conf/all/forwarding";
 const char SEPARATOR[] = "|";
 constexpr const char kTcpBeLiberal[] = "/proc/sys/net/netfilter/nf_conntrack_tcp_be_liberal";
 
@@ -172,7 +172,7 @@ bool TetherController::setIpFwdEnabled() {
     const char* value = disable ? "0" : "1";
     ALOGD("Setting IP forward enable = %s", value);
     success &= writeToFile(IPV4_FORWARDING_PROC_FILE, value);
-    success &= writeToFile(IPV6_FORWARDING_PROC_FILE, value);
+    //success &= writeToFile(IPV6_FORWARDING_PROC_FILE, value);
     if (disable) {
         // Turning off the forwarding sysconf in the kernel has the side effect
         // of turning on ICMP redirect, which is a security hazard.
-- 
2.34.1

